---
title: ctr_recalibration
date: 2017-11-23 20:21:40
tags: ML
---

### CTR为什么会不准？
在计算广告中，pCTR往往对比真实的CTR偏高或者偏低的现象，尤其在
1. 热门曝光广告和冷门曝光广告之间
2. 高CTR广告和低CTR广告之间

因此，CTR需要校准。

<!-- more -->

### CTR为什么要校准？
AUC体现序准；
logloss体现值准；
要计算商业价值最大化，因此需要值准；
因此需要校准；
校准之后，logloss会降低。

### CTR如何校准
CTR校准有很多方法，本质在于“拟合校准前和校准后”，即
f(pCTR校准前) = pCTR校准后
如何设计函数f，是校准的关键。

#### binning
binning就是样本等频分桶后，每个bin求平均，如下图：
 {% asset_img "图1.1.png" [图1.1.png] %}

#### Isotonic regression(保序回归）
保序回归，就是单调回归（保证按照自变量x和按照因变量y排序序不变，即成正比）
为何要保序？
为了保证不影响AUC，即默认原始CTR和校准后CTR的正相关性。
{% asset_img "图2.2.png" [图2.2.png] %}

### 重采样的校准
由于负样本抽样后，会造成点击率偏高的假象，需要将预测值还原成真实的值。调整的公式如下：

{% asset_img "图3.3.png" [图3.3.png] %}